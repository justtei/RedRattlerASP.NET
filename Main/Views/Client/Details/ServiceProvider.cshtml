@using MSLivingChoices.Entities.Client.Search.Criteria
@using MSLivingChoices.Mvc.Uipc.Client.Helpers
@using MSLivingChoices.Mvc.Uipc.Client.ViewModelsProviders

@model MSLivingChoices.Mvc.Uipc.Client.ViewModels.ServiceProviderDetailsVm

@{
    Layout = "~/Views/Client/Shared/_PageLayout.cshtml";
}

@section scripts
{
    @{ Html.RenderPartial("~/Views/Client/Search/Partial/PhotoTour.cshtml"); }

    <script type="text/javascript" src="https://s7.addthis.com/js/300/addthis_widget.js#pubid=xa-51f632df2d7a5c98"></script>
    <script type="text/javascript">
        mslc.resolve(['lib/ko'], function(ko) {
            ko.applyBindings(@Html.Json(Model.ServiceProvider.Images), document.getElementById('photo'));
        });

        mslc.resolve(['client/widgets/leadForm'], function(leadForm) {
            leadForm.initInline(@Html.Json(ClientViewModelsProvider.GetLeadFormVm(Model)));
            leadForm.initPopUpSharedData(@Html.Json(ClientViewModelsProvider.GetLeadFormVm(Model)));
        });

        mslc.resolve(['client/widgets/googlePublisherTag'], function(gpt) {
            gpt.initDetailsSlots({
                country: '@Model.Criteria.CountryCode()',
                state: '@Model.Criteria.StateCode()',
                city: '@Model.Criteria.City()'
            });
        }, 'init-gpt');

        mslc.resolve(['client/analytics/google', 'lib/jQuery'], function(ga, $) {
            var dimensions = {
                serviceProviderId: @Model.ServiceProvider.Id,
                bookNumber: '@Model.ServiceProvider.BookNumber'
            };

            ga.trackPageView(dimensions);
            $('a[data-community-link-type]').on('click', function() {
                var linkType = $(this).data('service-provider-link-type');

                ga.trackServiceProviderEvent('LinkVisit', linkType, dimensions);
            });

            $('a[data-phone-number]').on('click', function() {
                var eventLabel = $(this).data('phone-number');

                ga.trackServiceProviderEvent('PhoneClickToCall', eventLabel, dimensions);
            });
        }, 'ga-tracking');
    </script>

    @if (Model.ServiceProvider.DisplayProperties.Map)
    {
        <script type="text/javascript">
            mslc.resolve(['lib/jQuery', 'lib/ko', 'client/controls/maps/directions'], function($, ko, DirectionsMap) {
                var $target = $('[data-container="map"]'),
                    data = {
                        latitude: @Model.ServiceProvider.Address.Latitude,
                        longitude: @Model.ServiceProvider.Address.Longitude,
                        endingAddress: '@Html.Raw(Model.ServiceProvider.Address.ToString())',
                        printDirectionBaseUrl: '@Model.ServiceProvider.PrintDirectionBaseUrl'
                    },
                    model = new DirectionsMap(data, $target);

                ko.applyBindings(model, $target[0]);
            }, 'google-map-init');
        </script>
    }
}

<div class="inner-header">
    <div class="container">
        <div class="row">
            <div class="col-sm-12 text-center">
                <h1 class="inner-title text-white">Product & Service Details</h1>
            </div>
        </div>
    </div>
</div>

<section class="space-pt mb-4" itemscope itemtype="http://schema.org/ProfessionalService">
    <div class="container">
        <div class="row" id="photo">
            <div class="col-lg-7 mb-4 mb-md-5 mb-lg-0">
                <div class="owl-carousel owl-dots-bottom-center list" data-nav-arrow="true" data-nav-dots="false" data-items="1" data-md-items="1" data-sm-items="1" data-xs-items="1" data-xx-items="1" data-space="0">
                    @foreach (var Image in Model.ServiceProvider.Images)
                    {
                        <div class="item">
                            <img class="img-fluid" alt="" style="height: 400px;" src="@Image.Src">
                        </div>
                    }
                </div>
            </div>
            <div class="col-lg-5">
                <div class="property-detail p-0">
                    <h2 class="property-title">@Model.Seo.Header</h2>
                    <ul class="pl-0 property-info">
                        <li class="">
                            <i class="fas fa-map-marker-alt fa-1x mr-1 text-primary"></i>
                            <span>
                                EXACT - @Model.ServiceProvider.Address.City, @Model.ServiceProvider.Address.StateCode @Model.ServiceProvider.Address.Zip
                            </span>
                        </li>
                        <li class="">
                            <i class="fas fa-building fa-1x text-primary mr-1"></i><span>
                                Housing Provided:
                                <a href="#">55+ Community</a>  •  <a href="#">Apartments</a>
                            </span>
                        </li>
                        <li class="">
                            <i class="fas fa-phone-alt fa-1x text-primary mr-1"></i><span>
                                <a href="tel:@(Model.ServiceProvider.Phone)" class="click-to-call" data-phone-number="@(Model.ServiceProvider.Phone)">
                                    @Model.ServiceProvider.Phone
                                </a>
                            </span>
                        </li>
                        <li class="">
                            <p class="mb-0">
                                <address itemprop="address" itemscope itemtype="http://schema.org/PostalAddress">
                                    <span class="address-line" itemprop="streetAddress">@Model.ServiceProvider.Address.Line</span> <br />
                                    <span class="city" itemprop="addressLocality">@Model.ServiceProvider.Address.City</span>
                                    <span class="state" itemprop="addressRegion">@Model.ServiceProvider.Address.StateCode</span>
                                    <span itemprop="postalCode">@Model.ServiceProvider.Address.Zip</span>
                                </address>
                            </p>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="row justify-content-start mt-4 mt-lg-5">
            <div class="col-md-7">
                <div class="row">
                    <div class="col-lg-4">
                        <h3>Description</h3>
                    </div>
                    <div class="col-lg-8 pt-2">
                        <p>
                            @if (Model.ServiceProvider.DisplayProperties.Description)
                            {
                                @Model.ServiceProvider.Description
                            }
                        </p>
                    </div>
                </div>
                <hr class="my-4 my-md-5">
                <div class="row">
                    <div class="col-lg-4">
                        <h3>Service Categories</h3>
                    </div>
                    <div class="col-lg-8 pt-2">
                        <div class="row">
                            @foreach (var category in Model.ServiceProvider.ServiceCategories)
                            {
                                <div class="col-md-12">
                                    <ul class="property-list mb-0 pl-lg-0 pl-3">
                                        <li>@category</li>
                                    </ul>
                                </div>
                            }
                        </div>
                    </div>
                </div>
                <hr class="my-4 my-md-5">
                <div class="row">
                    <div class="col-lg-4">
                        <h3>Counties Served</h3>
                    </div>
                    <div class="col-lg-8 pt-2">
                        <p class="row">
                            @foreach (var county in Model.ServiceProvider.CountiesServed)
                            {
                                if (county.Equals(Model.ServiceProvider.CountiesServed.First()))
                                {
                                    @(county.Name)
                                }
                                else if (county.Equals(Model.ServiceProvider.CountiesServed.Last()))
                                {
                                    @(" and " + county.Name)
                                }
                                else
                                {
                                    @(", " + county.Name)
                                }
                            }
                            @(Model.ServiceProvider.CountiesServed.Count > 1 ? "Counties" : "County")
                        </p>
                    </div>
                </div>
            </div>
            <div class="col-md-5">
                @if (Model.ServiceProvider.DisplayProperties.LeadForm)
                {
                    Html.RenderPartial("~/Views/Client/Controls/LeadForm/DetailsInline.cshtml");
                }
            </div>
        </div>
    </div>

    
</section>




<script>
    console.log(@Html.Json(Model));
</script>
